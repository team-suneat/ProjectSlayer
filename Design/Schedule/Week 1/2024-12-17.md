# 12월 17일 수요일 (Day 2)

## 저장/로드 시스템 점검 및 보완

### 현재 구현 상태
**이미 구현된 기능:**
- [x] GameDataManager 기본 저장/로드 시스템
  - [x] 비동기 저장 지원 (USE_ASYNC_SAVE = true)
  - [x] 저장 쿨다운 시스템 (SAVE_COOLDOWN_TIME = 1.0f)
  - [x] 백업 저장 시스템 (3회마다 자동 백업)
  - [x] 암호화 지원 (AES)
  - [x] 복구 시스템 (LoadGameDataWithRecovery)
  - [x] 데이터 마이그레이션 시스템
- [x] 씬 전환 시 저장 로직
  - [x] GameMainScene.CleanupCurrentScene()에서 SaveGameData() 호출
  - [x] 씬 전환 전 자동 저장 구현됨
- [x] GameApp.Update()에서 ProcessPendingSave() 호출
  - [x] 대기 중인 저장 처리 시스템

**현재 저장되는 데이터 구조 (VProfile):**
- [x] VCharacter (캐릭터 데이터)
- [x] VCharacterLevel (레벨 데이터)
- [x] VCharacterStat (스탯 데이터)
- [x] VCharacterWeapon (무기 데이터)
- [x] VCharacterPotion (물약 데이터)
- [x] VCharacterItem (아이템 데이터)
- [x] VCurrency (재화 데이터)
- [x] VCharacterStage (스테이지 데이터)
- [x] VCharacterSlot (슬롯 데이터)
- [x] VStatistics (통계 데이터)

### 추가 구현 필요 사항
- [ ] 주기적 자동 저장 구현
  - [ ] 저장 주기 설정 (예: 30초마다)
  - [ ] 저장 트리거 관리
  - [ ] 저장 실패 시 재시도 로직
- [ ] 게임 종료 시 저장 로직
  - [ ] OnApplicationPause 처리 (GameApp에 추가)
  - [ ] OnApplicationFocus 처리 (GameApp에 추가)
  - [ ] 강제 종료 대응 (가능한 범위 내)

### 세이브 파일 관리 테스트
- [ ] 세이브 파일 관리 테스트
  - [ ] 세이브 파일 생성/삭제 테스트
  - [ ] 세이브 파일 로드 검증 테스트
  - [ ] 세이브 파일 백업/복구 테스트
  - [ ] 데이터 마이그레이션 테스트
  - [ ] 저장 실패 시나리오 테스트

### 데이터 저장 항목 확장 (향후 추가될 데이터)
- [ ] 게임 데이터 저장 구조 확장
  - [ ] 퀘스트 진행도 데이터 (향후 추가)
  - [ ] 출석보상 데이터 (향후 추가)
  - [ ] 스킬 데이터 (향후 추가)
  - [ ] 장비 데이터 (향후 추가)

### 데이터 구조 재설계 (현재 게임에 맞게)
- [ ] VCharacter 구조 단순화
  - [ ] 다중 캐릭터 관리 로직 제거
  - [ ] 단일 플레이어 데이터 구조로 변경
  - [ ] 스킬 슬롯 해금 상태 필드 추가
- [ ] VCharacterStat 분리
  - [ ] VCharacterEnhancement 클래스 구현
    - [ ] 골드로 구매하는 강화 능력치 필드 (공격력, 체력, 체력 회복량, 치명타 공격력, 치명타 확률, 회심의 일격, 회심의 일격 확률)
    - [ ] 성장 지식 필드 (괴력, 강철의 육체, 강인한 심장, 초인의 힘)
  - [ ] VCharacterGrowth 클래스 구현
    - [ ] SP(능력치 포인트) 필드
    - [ ] SP로 구매하는 능력치 필드 (STR, HP, VIT, CRI, LUK, ACC, DODGE)
- [ ] VCompanion 시스템 구현
  - [ ] VCompanion 기본 클래스 구현
  - [ ] VCompanionInfo 클래스 구현
    - [ ] 동료 해금 상태 저장
    - [ ] 동료 레벨 저장 (플레이어와 별개)
    - [ ] 강화패시브 레벨 저장 (3개 카테고리)
    - [ ] 전직 정보 저장 (1~7차)
    - [ ] 승급 옵션 저장 (전직별)
  - [ ] VCompanionPromotionOption 클래스 구현
  - [ ] VProfile에 VCompanion 추가
- [ ] 신규 데이터 클래스 구현
  - [ ] VCharacterAccessory 클래스 구현 (악세사리 데이터)
  - [ ] VRelic 클래스 구현 (유물 데이터)
  - [ ] VSpirit 클래스 구현 (정령 데이터)
- [ ] VProfile 업데이트
  - [ ] VCharacterEnhancement 추가
  - [ ] VCharacterGrowth 추가
  - [ ] VCompanion 추가
  - [ ] VCharacterAccessory 추가
  - [ ] VRelic 추가
  - [ ] VSpirit 추가
  - [ ] VCharacterPotion 제거
  - [ ] VCharacterItem 제거
  - [ ] VCharacterSlot 제거
- [ ] 데이터 마이그레이션 코드 작성
  - [ ] 기존 VCharacter 데이터를 새 구조로 변환
  - [ ] 기존 VCharacterStat 데이터를 VCharacterEnhancement와 VCharacterGrowth로 분리
  - [ ] 마이그레이션 테스트
- [ ] 데이터 구조 설계 문서 작성
  - [x] DATA_STRUCTURE_DESIGN.md 작성 완료

