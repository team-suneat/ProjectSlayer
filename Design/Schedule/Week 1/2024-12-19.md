# 12월 19일 금요일 (Day 4)

## 메인 HUD 구현 (UI)

### 재화 관리 (VCurrency 사용)
- [x] 재화 사용처 구현
  - [x] 재화 획득 시 VCurrency.Add() 호출 (자동으로 CURRENCY_EARNED 이벤트 발생)
  - [x] 재화 양 조회 시 VCurrency.GetAmount() 호출
  - [x] 재화 소비 시 VCurrency.CanUseOrNotify() 검증 후 VCurrency.Use() 호출
  - [x] 재화 부족 시 안내 처리 (UINoticeManager를 통해 자동 처리)
  - [x] 인게임 재화 초기화 시 VCurrency.ClearIngameCurrencies() 호출 (골드만 초기화)
- [x] 재화 이벤트 연동
  - [x] GlobalEventType.CURRENCY_EARNED 이벤트 리스너 구현 (UI 업데이트용)
  - [x] GlobalEventType.CURRENCY_PAYED 이벤트 리스너 구현 (UI 업데이트용)
  - [x] GlobalEventType.CURRENCY_SHORTAGE 이벤트 리스너 구현 (재화 부족 알림용)
- [x] 게임 데이터 로드 시 처리
  - [x] VCurrency.OnLoadGameData() 호출 처리 (현재 비어있음, 필요 시 구현)

### 재화 상시 표시 UI (HUDCurrency 사용)
- [x] 재화 표시 UI 연동 개선
  - [x] UI 자동 업데이트 확인 및 필요 시 개선

### Notice 시스템 구현
- [x] UINoticeManager 구현
  - [x] Notice UI 컴포넌트 중앙 관리
  - [x] 재화 부족 이벤트 자동 리스닝
  - [x] Notice 생성 및 완료 시 자동 제거
- [x] UINoticeBase 부모 클래스 구현
  - [x] 공통 기능 추출 (Show, FadeInOut, OnCompleted 이벤트)
  - [x] UICurrencyShortageNotice 리팩토링
  - [x] UIStageTitleNotice 리팩토링
- [x] UICurrencyShortageNotice 구현
  - [x] 재화 부족 알림 Notice 컴포넌트
  - [x] Format_Currency_Shortage 포맷 문자열 사용
  - [x] UINoticeBase 상속
- [x] UIStatPointShortageNotice 구현
  - [x] 스탯 포인트 부족 알림 Notice 컴포넌트
  - [x] Format_StatPoint_Shortage 포맷 문자열 사용
  - [x] UINoticeBase 상속
- [x] UIExperienceShortageNotice 구현
  - [x] 경험치 부족 알림 Notice 컴포넌트
  - [x] Format_Experience_Shortage 포맷 문자열 사용
  - [x] UINoticeBase 상속
- [x] GlobalEventType 이벤트 추가
  - [x] STAT_POINT_SHORTAGE 이벤트 추가
  - [x] EXPERIENCE_SHORTAGE 이벤트 추가
- [x] 데이터 모델 OrNotify 메서드 추가
  - [x] VCharacterGrowth에 CanConsumeStatPoint, CanConsumeStatPointOrNotify 메서드 추가
  - [x] VCharacterLevel에 CanLevelUp, CanLevelUpOrNotify 메서드 추가
- [x] ResourcesManager.UI.cs Spawn 메서드 추가
  - [x] SpawnStatPointShortageNotice 메서드 추가
  - [x] SpawnExperienceShortageNotice 메서드 추가
- [x] UINoticeManager 이벤트 리스너 추가
  - [x] STAT_POINT_SHORTAGE 이벤트 리스너 구현
  - [x] EXPERIENCE_SHORTAGE 이벤트 리스너 구현
  - [x] SpawnStatPointShortageNotice 메서드 추가
  - [x] SpawnExperienceShortageNotice 메서드 추가
- [x] 버튼 클릭 로직 수정
  - [x] UIGrowthButton.OnButtonClick()에서 CanConsumeStatPointOrNotify 사용
  - [x] UICharacterLevelUpButton.OnButtonClick()에서 CanLevelUpOrNotify 사용

---

## 저장/로드 시스템 점검 및 보완 (12/17 이월)

### 추가 구현 필요 사항
- [x] 게임 종료 시 저장 로직
  - [x] OnApplicationPause 처리 (GameApp에 추가)
  - [x] OnApplicationFocus 처리 (XGameApp에 추가)
  - [ ] 강제 종료 대응 (가능한 범위 내) → 2주차로 이월

---

## 시간 관리 시스템 구현 (데이터)

### 게임 접속 시간 기록 시스템 (VStatistics)
- [x] 기본 시간 필드 구현
  - [x] GameStartTime (게임 시작 시간)
  - [x] LastSaveTime (마지막 저장 시간)
- [x] 시간 관련 메서드 구현
  - [x] RegisterGameStartTime() - 게임 시작 시간 등록
  - [x] RegisterLastSaveTime() - 마지막 저장 시간 등록
  - [x] GetTotalPlayTime() - 총 플레이 시간 계산
  - [x] GetTotalPlayTimeString() - 총 플레이 시간 문자열 반환
  - [x] GetLastSaveTimeString() - 마지막 저장 시간 문자열 반환 (버그 수정: GameStartTime → LastSaveTime)
- [x] 게임 종료 시 LastSaveTime 업데이트
  - [x] OnApplicationPause/OnApplicationFocus에서 RegisterLastSaveTime() 호출
  - [x] 주기적 자동 저장 시 RegisterLastSaveTime() 호출 (GameDataManager.Save에서 처리)

### 오프라인 시간 계산 시스템
- [x] OfflineTimeManager 클래스 구현
  - [x] 마지막 플레이 시간 기록 (LastSaveTime 활용)
  - [x] 현재 시간과 비교하여 오프라인 시간 계산
  - [x] 오프라인 시간 제한 (최대 보상 시간 설정: 24시간)
  - [x] 오프라인 시간 검증 (시간 조작 방지)
  - [x] 게임 시작 시 오프라인 시간 계산 (LoadGameData 후)
  - [x] 앱 재개 시 오프라인 시간 재계산 (OnApplicationResume)
  - [x] 로그 시간 표시 형식 (시:분:초)
  - [x] 단일 책임 원칙에 따른 함수 분리

---

## 통계/기록 시스템 구현 (데이터)

### 통계 기록 시스템 (VStatistics)
- [x] 기본 통계 구조 정리
  - [x] 방치형 게임에 불필요한 통계 항목 제거
    - [x] 도전 횟수 (ChallengeCount) 제거
    - [x] 죽음 횟수 (DeathCount) 제거
    - [x] 처치한 몬스터 (KilledMonsters) 제거
    - [x] 스피드런 클리어 시간 (SpeedrunClearTime) 제거
    - [x] 도전 시작 시간 (ChallengeStartTime) 제거
    - [x] 난이도별 클리어 시간 (DifficultyStepClearTimes) 제거
    - [x] 현재 게임플레이 시간 (CurrentGameplayTime) 제거
  - [x] 게임 접속 시간 관련 필드만 유지 (GameStartTime, LastSaveTime)
- [ ] 통계 데이터 저장/로드 (VStatistics는 VProfile에 포함되어 자동 저장/로드됨) → 2주차로 이월
- [ ] 통계 표시 UI (향후 구현 예정) → 2주차로 이월
  - [ ] 총 플레이 시간 표시
  - [ ] 마지막 접속 시간 표시

---

